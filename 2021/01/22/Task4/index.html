<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  
  
  <title>The TASK4 | Hexo</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
  <meta name="description" content="任务简述学习主题：论⽂文分类（数据建模任务），利利⽤用已有数据建模，对新论⽂文进⾏行行类别分类；学习内容：使⽤用论⽂文标题完成类别分类；学习成果：学会⽂文本分类的基本⽅方法、TF-IDF等    思路介绍思路1：TF-IDF+机器学习分类器 直接使⽤TF-IDF对⽂文本提取特征，使⽤用分类器器进⾏分类，分类器的选择上可以使⽤SVM、LR、XGboost 等思路2：FastText FastText">
<meta property="og:type" content="article">
<meta property="og:title" content="The TASK4">
<meta property="og:url" content="http://example.com/2021/01/22/Task4/index.html">
<meta property="og:site_name" content="Hexo">
<meta property="og:description" content="任务简述学习主题：论⽂文分类（数据建模任务），利利⽤用已有数据建模，对新论⽂文进⾏行行类别分类；学习内容：使⽤用论⽂文标题完成类别分类；学习成果：学会⽂文本分类的基本⽅方法、TF-IDF等    思路介绍思路1：TF-IDF+机器学习分类器 直接使⽤TF-IDF对⽂文本提取特征，使⽤用分类器器进⾏分类，分类器的选择上可以使⽤SVM、LR、XGboost 等思路2：FastText FastText">
<meta property="og:locale" content="en_US">
<meta property="article:published_time" content="2021-01-22T15:18:39.414Z">
<meta property="article:modified_time" content="2021-01-22T15:25:37.154Z">
<meta property="article:author" content="John Doe">
<meta name="twitter:card" content="summary">
  
    <link rel="alternate" href="/atom.xml" title="Hexo" type="application/atom+xml">
  
  
    <link rel="shortcut icon" href="/favicon.png">
  
  
    
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/typeface-source-code-pro@0.0.71/index.min.css">

  
  
<link rel="stylesheet" href="/css/style.css">

  
    
<link rel="stylesheet" href="/fancybox/jquery.fancybox.min.css">

  
<meta name="generator" content="Hexo 5.3.0"></head>

<body>
  <div id="container">
    <div id="wrap">
      <header id="header">
  <div id="banner"></div>
  <div id="header-outer" class="outer">
    <div id="header-title" class="inner">
      <h1 id="logo-wrap">
        <a href="/" id="logo">Hexo</a>
      </h1>
      
    </div>
    <div id="header-inner" class="inner">
      <nav id="main-nav">
        <a id="main-nav-toggle" class="nav-icon"></a>
        
          <a class="main-nav-link" href="/">Home</a>
        
          <a class="main-nav-link" href="/archives">Archives</a>
        
      </nav>
      <nav id="sub-nav">
        
          <a id="nav-rss-link" class="nav-icon" href="/atom.xml" title="RSS Feed"></a>
        
        <a id="nav-search-btn" class="nav-icon" title="Search"></a>
      </nav>
      <div id="search-form-wrap">
        <form action="//google.com/search" method="get" accept-charset="UTF-8" class="search-form"><input type="search" name="q" class="search-form-input" placeholder="Search"><button type="submit" class="search-form-submit">&#xF002;</button><input type="hidden" name="sitesearch" value="http://example.com"></form>
      </div>
    </div>
  </div>
</header>

      <div class="outer">
        <section id="main"><article id="post-Task4" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/2021/01/22/Task4/" class="article-date">
  <time class="dt-published" datetime="2021-01-22T15:18:39.414Z" itemprop="datePublished">2021-01-22</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 class="p-name article-title" itemprop="headline name">
      The TASK4
    </h1>
  

      </header>
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <h2 id="任务简述"><a href="#任务简述" class="headerlink" title="任务简述"></a>任务简述</h2><p><code>学习主题：</code>论⽂文分类（数据建模任务），利利⽤用已有数据建模，对新论⽂文进⾏行行类别分类；<br><code>学习内容：</code>使⽤用论⽂文标题完成类别分类；<br><code>学习成果：</code>学会⽂文本分类的基本⽅方法、TF-IDF等  </p>
<hr>
<h2 id="思路介绍"><a href="#思路介绍" class="headerlink" title="思路介绍"></a>思路介绍</h2><p><code>思路1：TF-IDF+机器学习分类器 </code><br>直接使⽤TF-IDF对⽂文本提取特征，使⽤用分类器器进⾏分类，分类器的选择上可以使⽤SVM、LR、XGboost 等<br><code>思路2：FastText </code><br>FastText是⼊门款的词向量量，利用Facebook提供的FastText⼯具，可以快速构建分类器<br><code>思路3：WordVec+深度学习分类器 </code><br>WordVec是进阶款的词向量，并通过构建深度学习分类完成分类。深度学习分类的⽹络结构可以选择 TextCNN、TextRnn或者BiLSTM。<br><code>思路路4：Bert词向量 </code><br>Bert是⾼配款的词向量，具有强⼤的建模学习能⼒。 </p>
<h2 id="任务1导入数据"><a href="#任务1导入数据" class="headerlink" title="任务1导入数据"></a>任务1导入数据</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> seaborn <span class="keyword">as</span> sns</span><br><span class="line"><span class="keyword">from</span> bs4 <span class="keyword">import</span> BeautifulSoup</span><br><span class="line"><span class="keyword">import</span> re</span><br><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"><span class="keyword">import</span> json</span><br><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</span><br><span class="line"><span class="keyword">import</span> matplotlib.pyplot <span class="keyword">as</span> plt</span><br></pre></td></tr></table></figure>

<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">data = []</span><br><span class="line"><span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&#x27;arxiv-metadata-oai-snapshot.json&#x27;</span>, <span class="string">&#x27;r&#x27;</span>) <span class="keyword">as</span> f:</span><br><span class="line">    <span class="keyword">for</span> idx, line <span class="keyword">in</span> <span class="built_in">enumerate</span>(f):</span><br><span class="line">        d = json.loads(line);</span><br><span class="line">        d = &#123;<span class="string">&#x27;title&#x27;</span> : d[<span class="string">&#x27;title&#x27;</span>], <span class="string">&#x27;categories&#x27;</span> : d[<span class="string">&#x27;categories&#x27;</span>], \</span><br><span class="line">            <span class="string">&#x27;abstract&#x27;</span> : d[<span class="string">&#x27;abstract&#x27;</span>]&#125;</span><br><span class="line">        data.append(d)</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">if</span>(idx &gt; <span class="number">200000</span>): <span class="comment">#删选出200002个数据</span></span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line">            </span><br><span class="line">data = pd.DataFrame(data)</span><br></pre></td></tr></table></figure>

<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">data <span class="comment">#查看数据</span></span><br></pre></td></tr></table></figure>



<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

<pre><code>.dataframe tbody tr th &#123;
    vertical-align: top;
&#125;

.dataframe thead th &#123;
    text-align: right;
&#125;</code></pre>
<p></style></p>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>title</th>
      <th>categories</th>
      <th>abstract</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Calculation of prompt diphoton production cros...</td>
      <td>hep-ph</td>
      <td>A fully differential calculation in perturba...</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Sparsity-certifying Graph Decompositions</td>
      <td>math.CO cs.CG</td>
      <td>We describe a new algorithm, the $(k,\ell)$-...</td>
    </tr>
    <tr>
      <th>2</th>
      <td>The evolution of the Earth-Moon system based o...</td>
      <td>physics.gen-ph</td>
      <td>The evolution of Earth-Moon system is descri...</td>
    </tr>
    <tr>
      <th>3</th>
      <td>A determinant of Stirling cycle numbers counts...</td>
      <td>math.CO</td>
      <td>We show that a determinant of Stirling cycle...</td>
    </tr>
    <tr>
      <th>4</th>
      <td>From dyadic $\Lambda_{\alpha}$ to $\Lambda_{\a...</td>
      <td>math.CA math.FA</td>
      <td>In this paper we show how to compute the $\L...</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>199997</th>
      <td>Relaxation dynamics of stochastic long-range i...</td>
      <td>cond-mat.stat-mech</td>
      <td>Long-range interacting systems, while relaxi...</td>
    </tr>
    <tr>
      <th>199998</th>
      <td>Identification of a connection from Cauchy dat...</td>
      <td>math.DG math.AP</td>
      <td>We consider a connection $\nabla^X$ on a com...</td>
    </tr>
    <tr>
      <th>199999</th>
      <td>Adhesive penetration in Beech wood Part II: Pe...</td>
      <td>cond-mat.mtrl-sci</td>
      <td>We propose an analytical model to predict th...</td>
    </tr>
    <tr>
      <th>200000</th>
      <td>Adhesive Penetration in Beech Wood Part I: Exp...</td>
      <td>cond-mat.mtrl-sci</td>
      <td>A study with synchrotron radiation X-ray tom...</td>
    </tr>
    <tr>
      <th>200001</th>
      <td>Supernovae Powered by Collapsar Accretion in G...</td>
      <td>astro-ph.HE astro-ph.SR</td>
      <td>The association of long-duration gamma-ray b...</td>
    </tr>
  </tbody>
</table>
<p>200002 rows × 3 columns</p>
</div>



<h2 id="任务2数据处理"><a href="#任务2数据处理" class="headerlink" title="任务2数据处理"></a>任务2数据处理</h2><ol>
<li>将abstrct列和title列整合</li>
<li>处理categories列,关注多类别</li>
</ol>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">data[<span class="string">&#x27;text&#x27;</span>] = data[<span class="string">&#x27;title&#x27;</span>] + data[<span class="string">&#x27;abstract&#x27;</span>]</span><br><span class="line">data[<span class="string">&#x27;text&#x27;</span>] = data[<span class="string">&#x27;text&#x27;</span>].apply(<span class="keyword">lambda</span> x: x.replace(<span class="string">&#x27;\n&#x27;</span>, <span class="string">&#x27; &#x27;</span>))</span><br><span class="line">data[<span class="string">&#x27;text&#x27;</span>] = data[<span class="string">&#x27;text&#x27;</span>].apply(<span class="keyword">lambda</span> x: x.lower())</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">data</span><br></pre></td></tr></table></figure>



<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

<pre><code>.dataframe tbody tr th &#123;
    vertical-align: top;
&#125;

.dataframe thead th &#123;
    text-align: right;
&#125;</code></pre>
<p></style></p>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>title</th>
      <th>categories</th>
      <th>abstract</th>
      <th>text</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Calculation of prompt diphoton production cros...</td>
      <td>hep-ph</td>
      <td>A fully differential calculation in perturba...</td>
      <td>calculation of prompt diphoton production cros...</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Sparsity-certifying Graph Decompositions</td>
      <td>math.CO cs.CG</td>
      <td>We describe a new algorithm, the $(k,\ell)$-...</td>
      <td>sparsity-certifying graph decompositions  we d...</td>
    </tr>
    <tr>
      <th>2</th>
      <td>The evolution of the Earth-Moon system based o...</td>
      <td>physics.gen-ph</td>
      <td>The evolution of Earth-Moon system is descri...</td>
      <td>the evolution of the earth-moon system based o...</td>
    </tr>
    <tr>
      <th>3</th>
      <td>A determinant of Stirling cycle numbers counts...</td>
      <td>math.CO</td>
      <td>We show that a determinant of Stirling cycle...</td>
      <td>a determinant of stirling cycle numbers counts...</td>
    </tr>
    <tr>
      <th>4</th>
      <td>From dyadic $\Lambda_{\alpha}$ to $\Lambda_{\a...</td>
      <td>math.CA math.FA</td>
      <td>In this paper we show how to compute the $\L...</td>
      <td>from dyadic $\lambda_{\alpha}$ to $\lambda_{\a...</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>199997</th>
      <td>Relaxation dynamics of stochastic long-range i...</td>
      <td>cond-mat.stat-mech</td>
      <td>Long-range interacting systems, while relaxi...</td>
      <td>relaxation dynamics of stochastic long-range i...</td>
    </tr>
    <tr>
      <th>199998</th>
      <td>Identification of a connection from Cauchy dat...</td>
      <td>math.DG math.AP</td>
      <td>We consider a connection $\nabla^X$ on a com...</td>
      <td>identification of a connection from cauchy dat...</td>
    </tr>
    <tr>
      <th>199999</th>
      <td>Adhesive penetration in Beech wood Part II: Pe...</td>
      <td>cond-mat.mtrl-sci</td>
      <td>We propose an analytical model to predict th...</td>
      <td>adhesive penetration in beech wood part ii: pe...</td>
    </tr>
    <tr>
      <th>200000</th>
      <td>Adhesive Penetration in Beech Wood Part I: Exp...</td>
      <td>cond-mat.mtrl-sci</td>
      <td>A study with synchrotron radiation X-ray tom...</td>
      <td>adhesive penetration in beech wood part i: exp...</td>
    </tr>
    <tr>
      <th>200001</th>
      <td>Supernovae Powered by Collapsar Accretion in G...</td>
      <td>astro-ph.HE astro-ph.SR</td>
      <td>The association of long-duration gamma-ray b...</td>
      <td>supernovae powered by collapsar accretion in g...</td>
    </tr>
  </tbody>
</table>
<p>200002 rows × 4 columns</p>
</div>




<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">data = data.drop([<span class="string">&#x27;abstract&#x27;</span>, <span class="string">&#x27;title&#x27;</span>], axis = <span class="number">1</span>)</span><br><span class="line">data</span><br></pre></td></tr></table></figure>



<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

<pre><code>.dataframe tbody tr th &#123;
    vertical-align: top;
&#125;

.dataframe thead th &#123;
    text-align: right;
&#125;</code></pre>
<p></style></p>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>categories</th>
      <th>text</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>hep-ph</td>
      <td>calculation of prompt diphoton production cros...</td>
    </tr>
    <tr>
      <th>1</th>
      <td>math.CO cs.CG</td>
      <td>sparsity-certifying graph decompositions  we d...</td>
    </tr>
    <tr>
      <th>2</th>
      <td>physics.gen-ph</td>
      <td>the evolution of the earth-moon system based o...</td>
    </tr>
    <tr>
      <th>3</th>
      <td>math.CO</td>
      <td>a determinant of stirling cycle numbers counts...</td>
    </tr>
    <tr>
      <th>4</th>
      <td>math.CA math.FA</td>
      <td>from dyadic $\lambda_{\alpha}$ to $\lambda_{\a...</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>199997</th>
      <td>cond-mat.stat-mech</td>
      <td>relaxation dynamics of stochastic long-range i...</td>
    </tr>
    <tr>
      <th>199998</th>
      <td>math.DG math.AP</td>
      <td>identification of a connection from cauchy dat...</td>
    </tr>
    <tr>
      <th>199999</th>
      <td>cond-mat.mtrl-sci</td>
      <td>adhesive penetration in beech wood part ii: pe...</td>
    </tr>
    <tr>
      <th>200000</th>
      <td>cond-mat.mtrl-sci</td>
      <td>adhesive penetration in beech wood part i: exp...</td>
    </tr>
    <tr>
      <th>200001</th>
      <td>astro-ph.HE astro-ph.SR</td>
      <td>supernovae powered by collapsar accretion in g...</td>
    </tr>
  </tbody>
</table>
<p>200002 rows × 2 columns</p>
</div>




<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">data[<span class="string">&#x27;categories&#x27;</span>] = data[<span class="string">&#x27;categories&#x27;</span>].apply(<span class="keyword">lambda</span> x: x.split(<span class="string">&#x27; &#x27;</span>))</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<h3 id="小实验–split-的功能"><a href="#小实验–split-的功能" class="headerlink" title="小实验–split()的功能"></a>小实验–split()的功能</h3><pre><code>输入:a = &#39;asd 123123,asd oaskf-cxv_123@#$#%#%^$%&#39;
a = a.split(&#39; &#39;)
a 
输出[&#39;asd&#39;, &#39;123123,asd&#39;, &#39;oaskf-cxv_123@#$#%#%^$%&#39;]</code></pre>
<p>字符串1.split(‘分隔符a’):生成出用a分割字符串1的列表</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">data[<span class="string">&#x27;categories_big&#x27;</span>] = data[<span class="string">&#x27;categories&#x27;</span>].apply(<span class="keyword">lambda</span> x :\</span><br><span class="line">                              [xx.split(<span class="string">&#x27;.&#x27;</span>)[<span class="number">0</span>] <span class="keyword">for</span> xx <span class="keyword">in</span> x])</span><br><span class="line">data</span><br></pre></td></tr></table></figure>



<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

<pre><code>.dataframe tbody tr th &#123;
    vertical-align: top;
&#125;

.dataframe thead th &#123;
    text-align: right;
&#125;</code></pre>
<p></style></p>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>categories</th>
      <th>text</th>
      <th>categories_big</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>[hep-ph]</td>
      <td>calculation of prompt diphoton production cros...</td>
      <td>[hep-ph]</td>
    </tr>
    <tr>
      <th>1</th>
      <td>[math.CO, cs.CG]</td>
      <td>sparsity-certifying graph decompositions  we d...</td>
      <td>[math, cs]</td>
    </tr>
    <tr>
      <th>2</th>
      <td>[physics.gen-ph]</td>
      <td>the evolution of the earth-moon system based o...</td>
      <td>[physics]</td>
    </tr>
    <tr>
      <th>3</th>
      <td>[math.CO]</td>
      <td>a determinant of stirling cycle numbers counts...</td>
      <td>[math]</td>
    </tr>
    <tr>
      <th>4</th>
      <td>[math.CA, math.FA]</td>
      <td>from dyadic $\lambda_{\alpha}$ to $\lambda_{\a...</td>
      <td>[math, math]</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>199997</th>
      <td>[cond-mat.stat-mech]</td>
      <td>relaxation dynamics of stochastic long-range i...</td>
      <td>[cond-mat]</td>
    </tr>
    <tr>
      <th>199998</th>
      <td>[math.DG, math.AP]</td>
      <td>identification of a connection from cauchy dat...</td>
      <td>[math, math]</td>
    </tr>
    <tr>
      <th>199999</th>
      <td>[cond-mat.mtrl-sci]</td>
      <td>adhesive penetration in beech wood part ii: pe...</td>
      <td>[cond-mat]</td>
    </tr>
    <tr>
      <th>200000</th>
      <td>[cond-mat.mtrl-sci]</td>
      <td>adhesive penetration in beech wood part i: exp...</td>
      <td>[cond-mat]</td>
    </tr>
    <tr>
      <th>200001</th>
      <td>[astro-ph.HE, astro-ph.SR]</td>
      <td>supernovae powered by collapsar accretion in g...</td>
      <td>[astro-ph, astro-ph]</td>
    </tr>
  </tbody>
</table>
<p>200002 rows × 3 columns</p>
</div>




<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> sklearn.preprocessing <span class="keyword">import</span> MultiLabelBinarizer</span><br><span class="line">mlb = MultiLabelBinarizer()</span><br><span class="line">data_label = mlb.fit_transform(data[<span class="string">&#x27;categories_big&#x27;</span>].iloc[:])</span><br><span class="line">data_label</span><br></pre></td></tr></table></figure>



<pre><code>array([[0, 0, 0, ..., 0, 0, 0],
       [0, 0, 1, ..., 0, 0, 0],
       [0, 0, 0, ..., 0, 0, 0],
       ...,
       [0, 1, 0, ..., 0, 0, 0],
       [0, 1, 0, ..., 0, 0, 0],
       [1, 0, 0, ..., 0, 0, 0]])</code></pre>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">data[<span class="string">&#x27;categories_big&#x27;</span>].iloc[:]</span><br><span class="line"><span class="comment">#综上mlb.fit_transform(...)的功能就是生成二维矩阵</span></span><br></pre></td></tr></table></figure>



<pre><code>0                     [hep-ph]
1                   [math, cs]
2                    [physics]
3                       [math]
4                 [math, math]
                  ...         
199997              [cond-mat]
199998            [math, math]
199999              [cond-mat]
200000              [cond-mat]
200001    [astro-ph, astro-ph]
Name: categories_big, Length: 200002, dtype: object</code></pre>
<h2 id="任务3训练模型"><a href="#任务3训练模型" class="headerlink" title="任务3训练模型"></a>任务3训练模型</h2><h3 id="思路1-用TFIDF提取特征"><a href="#思路1-用TFIDF提取特征" class="headerlink" title="思路1:用TFIDF提取特征"></a>思路1:用TFIDF提取特征</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> sklearn.feature_extraction.text <span class="keyword">import</span> TfidfVectorizer</span><br><span class="line"><span class="comment">#从sklearn中选取特征值抽取函数</span></span><br><span class="line">vectorizer = TfidfVectorizer(max_features = <span class="number">4000</span>)</span><br><span class="line">data_tfidf = vectorizer.fit_transform(data[<span class="string">&#x27;text&#x27;</span>].iloc[:])</span><br><span class="line"><span class="comment">#抽取text矩阵的特征值</span></span><br></pre></td></tr></table></figure>

<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> sklearn.model_selection <span class="keyword">import</span> train_test_split</span><br><span class="line"><span class="comment">#引入划分训练集函数</span></span><br><span class="line">x_train, x_test, y_train, y_test = train_test_split(data_tfidf, data_label,</span><br><span class="line">                                       test_size = <span class="number">0.2</span>, random_state = <span class="number">1</span>)</span><br><span class="line">x_train, x_test, y_train, y_test </span><br><span class="line"><span class="comment">#x选取data_tfidf  y选取data_label</span></span><br><span class="line"><span class="comment">#训练集与测试集遵从4:1,完全随机抽取</span></span><br></pre></td></tr></table></figure>



<pre><code>(&lt;160001x4000 sparse matrix of type &#39;&lt;class &#39;numpy.float64&#39;&gt;&#39;
     with 10919799 stored elements in Compressed Sparse Row format&gt;,
 &lt;40001x4000 sparse matrix of type &#39;&lt;class &#39;numpy.float64&#39;&gt;&#39;
     with 2734528 stored elements in Compressed Sparse Row format&gt;,
 array([[0, 0, 0, ..., 0, 0, 0],
        [1, 0, 0, ..., 0, 0, 0],
        [0, 0, 0, ..., 0, 0, 0],
        ...,
        [0, 1, 0, ..., 0, 0, 0],
        [0, 0, 0, ..., 0, 0, 0],
        [0, 1, 0, ..., 0, 0, 0]]),
 array([[0, 1, 0, ..., 0, 0, 0],
        [0, 1, 0, ..., 0, 0, 0],
        [0, 0, 0, ..., 0, 0, 0],
        ...,
        [0, 1, 0, ..., 0, 0, 0],
        [0, 0, 0, ..., 0, 0, 0],
        [0, 0, 0, ..., 0, 0, 0]]))</code></pre>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> sklearn.multioutput <span class="keyword">import</span> MultiOutputClassifier</span><br><span class="line"><span class="keyword">from</span> sklearn.naive_bayes <span class="keyword">import</span> MultinomialNB</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">clf = MultiOutputClassifier(MultinomialNB()).fit(x_train, y_train)</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#检验数据</span></span><br><span class="line"><span class="keyword">from</span> sklearn.metrics <span class="keyword">import</span> classification_report</span><br><span class="line">print(classification_report(y_test, clf.predict(x_test)))</span><br></pre></td></tr></table></figure>
<pre><code>              precision    recall  f1-score   support

           0       0.95      0.85      0.90      7872
           1       0.85      0.78      0.81      7329
           2       0.77      0.72      0.74      2970
           3       0.00      0.00      0.00         2
           4       0.72      0.47      0.57      2149
           5       0.51      0.67      0.58       993
           6       0.89      0.35      0.50       538
           7       0.71      0.68      0.70      3657
           8       0.75      0.62      0.68      3382
           9       0.85      0.88      0.86     10809
          10       0.41      0.11      0.18      1796
          11       0.80      0.04      0.07       737
          12       0.44      0.33      0.38       540
          13       0.52      0.34      0.41      1070
          14       0.70      0.15      0.25      3435
          15       0.83      0.19      0.31       687
          16       0.88      0.18      0.30       249
          17       0.89      0.43      0.58      2565
          18       0.79      0.36      0.49       689

   micro avg       0.81      0.65      0.72     51469
   macro avg       0.70      0.43      0.49     51469
weighted avg       0.80      0.65      0.69     51469
 samples avg       0.72      0.72      0.70     51469



D:\Program\anoconda3\lib\site-packages\sklearn\metrics\_classification.py:1245: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
D:\Program\anoconda3\lib\site-packages\sklearn\metrics\_classification.py:1245: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 in samples with no predicted labels. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))</code></pre>
<h3 id="思路2-使用深度学习模型后进行词嵌入训练"><a href="#思路2-使用深度学习模型后进行词嵌入训练" class="headerlink" title="思路2:使用深度学习模型后进行词嵌入训练"></a>思路2:使用深度学习模型后进行词嵌入训练</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> sklearn.model_selection <span class="keyword">import</span> train_test_split</span><br><span class="line">x_train, x_test, y_train, y_test = train_test_split(data[<span class="string">&#x27;text&#x27;</span>].iloc[:],\</span><br><span class="line">                                       data_label, test_size = <span class="number">0.2</span>, \</span><br><span class="line">                                                    random_state = <span class="number">1</span>)</span><br></pre></td></tr></table></figure>

<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 对数据集进行编码</span></span><br><span class="line">max_features = <span class="number">200</span></span><br><span class="line">max_len = <span class="number">150</span></span><br><span class="line">embed_size = <span class="number">100</span></span><br><span class="line">batch_size = <span class="number">64</span></span><br><span class="line">epochs = <span class="number">5</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># import os</span></span><br><span class="line"><span class="comment"># os.environ[&#x27;KERAS_BACKEND&#x27;] = &#x27;theano&#x27;</span></span><br><span class="line"><span class="keyword">import</span> tensorflow <span class="keyword">as</span> tf</span><br><span class="line"><span class="comment"># from keras.preprocessing.text import Tokenizer</span></span><br><span class="line"><span class="comment"># from keras.preprocessing import sequence</span></span><br><span class="line"></span><br><span class="line">tokens = Tokenizer(num_words = max_features)</span><br><span class="line">tokens.fit_on_texts(<span class="built_in">list</span>(x_train) + <span class="built_in">list</span>(x_test))</span><br><span class="line"></span><br><span class="line">x_sub_train = tokens.texts_to_sequences(x_train)</span><br><span class="line">x_sub_test = tokens.texts_to_sequences(x_test)</span><br><span class="line"></span><br><span class="line">x_sub_train = sequence.pad_sequences(x_sub_train, maxlen = max_len)</span><br><span class="line">x_sub_test = sequence.pad_sequences(x_sub_test, maxlen = max_len)</span><br></pre></td></tr></table></figure>

<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># LSTM model # Keras Layers: from keras.layers import Dense,Input,LSTM,Bidirectional,Activation,Conv1D,GRU from keras.layers import Dropout,Embedding,GlobalMaxPooling1D, MaxPooling1D, Add, Flatten from keras.layers import GlobalAveragePooling1D, GlobalMaxPooling1D, concatenate, SpatialDropout1D# Keras Callback Functions: from keras.callbacks import Callback from keras.callbacks import EarlyStopping,ModelCheckpoint from keras import initializers, regularizers, constraints, optimizers, layers, callbacks from keras.models import Model from keras.optimizers import Adam</span></span><br><span class="line"> </span><br><span class="line">sequence_input = Input(shape=(max_len, )) </span><br><span class="line">x = Embedding(max_features, embed_size,trainable = <span class="literal">False</span>)(sequence_input)</span><br><span class="line">x = SpatialDropout1D(<span class="number">0.2</span>)(x) x = Bidirectional(GRU(<span class="number">128</span>, return_sequences=<span class="literal">True</span>,dropout=<span class="number">0.1</span>,recurrent_dropout=<span class="number">0.1</span>))(x) </span><br><span class="line">x = Conv1D(<span class="number">64</span>, kernel_size = <span class="number">3</span>, padding = <span class="string">&quot;valid&quot;</span>, kernel_initializer = <span class="string">&quot;glorot_uniform&quot;</span>)(x) </span><br><span class="line">avg_pool = GlobalAveragePooling1D()(x) max_pool = GlobalMaxPooling1D()(x) x = concatenate([avg_pool, max_pool]) </span><br><span class="line">preds = Dense(<span class="number">20</span>, activation=<span class="string">&quot;sigmoid&quot;</span>)(x)</span><br><span class="line"> </span><br><span class="line">model = Model(sequence_input, preds) </span><br><span class="line">model.<span class="built_in">compile</span>(loss=<span class="string">&#x27;binary_crossentropy&#x27;</span>,optimizer=Adam(lr=<span class="number">1e-3</span>),metrics= [<span class="string">&#x27;accuracy&#x27;</span>]) model.fit(x_sub_train, y_train, batch_size=batch_size, epochs=epochs)</span><br></pre></td></tr></table></figure>
      
    </div>
    <footer class="article-footer">
      <a data-url="http://example.com/2021/01/22/Task4/" data-id="ckk8fov5v0004ocu5g0iyh3iw" data-title="The TASK4" class="article-share-link">Share</a>
      
      
      
    </footer>
  </div>
  
    
<nav id="article-nav">
  
    <a href="/2021/01/25/Task5/" id="article-nav-newer" class="article-nav-link-wrap">
      <strong class="article-nav-caption">Newer</strong>
      <div class="article-nav-title">
        
          TASK5
        
      </div>
    </a>
  
  
    <a href="/2021/01/19/Task3/" id="article-nav-older" class="article-nav-link-wrap">
      <strong class="article-nav-caption">Older</strong>
      <div class="article-nav-title">The TASK3</div>
    </a>
  
</nav>

  
</article>


</section>
        
          <aside id="sidebar">
  
    

  
    

  
    
  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Archives</h3>
    <div class="widget">
      <ul class="archive-list"><li class="archive-list-item"><a class="archive-list-link" href="/archives/2021/01/">January 2021</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Recent Posts</h3>
    <div class="widget">
      <ul>
        
          <li>
            <a href="/2021/01/25/Task5/">TASK5</a>
          </li>
        
          <li>
            <a href="/2021/01/22/Task4/">The TASK4</a>
          </li>
        
          <li>
            <a href="/2021/01/19/Task3/">The TASK3</a>
          </li>
        
          <li>
            <a href="/2021/01/19/Task2/">The TASK2</a>
          </li>
        
          <li>
            <a href="/2021/01/19/Task1/">The TASK1</a>
          </li>
        
      </ul>
    </div>
  </div>

  
</aside>
        
      </div>
      <footer id="footer">
  
  <div class="outer">
    <div id="footer-info" class="inner">
      
      &copy; 2021 John Doe<br>
      Powered by <a href="https://hexo.io/" target="_blank">Hexo</a>
    </div>
  </div>
</footer>

    </div>
    <nav id="mobile-nav">
  
    <a href="/" class="mobile-nav-link">Home</a>
  
    <a href="/archives" class="mobile-nav-link">Archives</a>
  
</nav>
    


<script src="/js/jquery-3.4.1.min.js"></script>



  
<script src="/fancybox/jquery.fancybox.min.js"></script>




<script src="/js/script.js"></script>





  </div>
</body>
</html>